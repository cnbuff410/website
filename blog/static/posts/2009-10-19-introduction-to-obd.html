<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.11: http://docutils.sourceforge.net/" />
<title>自己监控爱车的信息－OBD系统介绍</title>
<meta name="author" content="cnbuff410" />
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7614 2013-02-21 15:55:51Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title, .code .error {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math, pre.code {
  margin-left: 2em ;
  margin-right: 2em }

pre.code .ln { color: grey; } /* line numbers */
pre.code, code { background-color: #eeeeee }
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

/* "booktabs" style (no vertical lines) */
table.docutils.booktabs {
  border: 0px;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.docutils.booktabs * {
  border: 0px;
}
table.docutils.booktabs th {
  border-bottom: thin solid;
  text-align: left;
}

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
<style type="text/css">

/*
:Author: Kun Li
:Contact: likunarmstrong@gmail.com
:Copyright: This stylesheet has been placed in the public domain.

Stylesheet for use with Docutils for my blog.
*/

table.footnote {
  border-left: solid 1px #F2FFFC;
  margin-left: 1px }

a.toc-backref {
  text-decoration: none ;
  color: #F2FFFC }

/* Override the css set by grayscale.css */
ul {
    list-style-type: disc;
}

table.docutils {
    margin-bottom: 1.5em;
}

</style>
</head>
<body>
<div class="document" id="obd">
<h1 class="title">自己监控爱车的信息－OBD系统介绍</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>cnbuff410</td></tr>
<tr><th class="docinfo-name">Contact:</th>
<td><a class="first last reference external" href="mailto:likunarmstrong&#37;&#52;&#48;gmail&#46;com">likunarmstrong<span>&#64;</span>gmail<span>&#46;</span>com</a></td></tr>
</tbody>
</table>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id19">OBD简介</a></li>
<li><a class="reference internal" href="#id2" id="id20">OBD接口介绍</a></li>
<li><a class="reference internal" href="#id3" id="id21">OBD数据介绍</a><ul>
<li><a class="reference internal" href="#id4" id="id22">数据协议标准</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id5" id="id23">OBD工具</a><ul>
<li><a class="reference internal" href="#id6" id="id24">硬件工具</a></li>
<li><a class="reference internal" href="#id9" id="id25">软件工具</a></li>
<li><a class="reference internal" href="#id10" id="id26">如何购买适合自己的工具</a><ul>
<li><a class="reference internal" href="#id11" id="id27">这套工具能用于你的爱车么？</a></li>
<li><a class="reference internal" href="#id12" id="id28">这套工具能支持哪些参数输出？</a></li>
<li><a class="reference internal" href="#id13" id="id29">这套工具是可升级的么？</a></li>
<li><a class="reference internal" href="#id14" id="id30">这套工具的说明文档完整么？</a></li>
<li><a class="reference internal" href="#id15" id="id31">这套工具有没有数据记录功能？</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id16" id="id32">OBD资料汇总</a></li>
</ul>
</div>
<p>前段时间因为项目的关系，接触了一阵OBD-II系统，觉得很不错，对于喜欢自己DIY的汽车
爱好者来说是值得花时间看一看的，我也准备以后有空就写一下这方面的东西。今天先大
体介绍以下整个系统的概况吧，</p>
<div class="section" id="id1">
<h1><a class="toc-backref" href="#id19">OBD简介</a></h1>
<p>OBD是On-board diagnostics的缩写，最早是在1975年的时候提出来的。1980年前后，通用将其实现为标准的接口和协议并用在自家的汽车组装线上，作为调试工具，这个协议当时叫做’assembly line diagnostic link’ (ALDL)。到了1987年，加州就开始强制性要求所有加州的新车都必须具有一定的OBD信息输出，这也就是OBD-I系统的雏形。</p>
<p>1994年的时候，OBD-II规范被提出并进行讨论。1996年1月1日，美国规定，所有汽车和卡车制造出厂在美国销售都必须配有OBD-II装备。01年开始，欧共体也出台相似规定，强制要求欧洲销售车辆具备EOBD系统，这玩意其实就是OBD-II的一种版本。</p>
<p>也就是说，只要你的汽车</p>
<ul class="simple">
<li>是在美国买的，并且是在1996年之后生产的</li>
<li>是在欧洲购买的，2001年之后的型号，并且是烧汽油的</li>
<li>是在欧洲购买的，2004年之后的型号，并且是烧柴油的</li>
</ul>
<p>那就肯定装有OBD-II系统。我目前不是很清楚国内该系统的普及情况，但相对高端点的汽车现在应该都开始加装这个系统了。</p>
</div>
<div class="section" id="id2">
<h1><a class="toc-backref" href="#id20">OBD接口介绍</a></h1>
<p>OBD-II车载接口是这样的</p>
<img alt="http://www.obdii.com/images/connectorblue.GIF" src="http://www.obdii.com/images/connectorblue.GIF" />
<p>标准化的接口定义是</p>
<ol class="arabic simple">
<li><ul class="first">
<li></li>
</ul>
</li>
<li>Bus positive Line of SAE-J1850 PWM and SAE-1850 VPW</li>
<li>Ford DCL(+) Argentina, Brazil (pre OBD-II) 1997-2000, Usa, Europe, etc.</li>
<li>Chassis ground</li>
<li>Signal ground</li>
<li>CAN high (ISO 15765-4 and SAE-J2284)</li>
<li>K line of ISO 9141-2 and ISO 14230-4</li>
<li><ul class="first">
<li></li>
</ul>
</li>
<li><ul class="first">
<li></li>
</ul>
</li>
<li>Bus negative Line of SAE-J1850 PWM only (not SAE-1850 VPW)</li>
<li>Ford DCL(-) Argentina, Brazil (pre OBD-II) 1997-2000, Usa, Europe, etc.</li>
<li><ul class="first">
<li></li>
</ul>
</li>
<li><ul class="first">
<li></li>
</ul>
</li>
<li>CAN low (ISO 15765-4 and SAE-J2284)</li>
<li>L line of ISO 9141-2 and ISO 14230-4</li>
<li>Battery voltage</li>
</ol>
<p>未定义的针脚则是留给厂商自己配置的。这些都很好理解，我就不赘述了。</p>
</div>
<div class="section" id="id3">
<h1><a class="toc-backref" href="#id21">OBD数据介绍</a></h1>
<p>其实最开始的时候，搞OBD的人就是想坚持汽车引擎的排放，以此来判断污染是不是超标了。后来，因为这个系统越来越流行，也越来越标准化，各大厂商就开始将其扩展，把很多的故障信息或者性能信息都放在上面。假如说你的车出问题了，送到修车铺，那大多数修车点都会先用工具从OBD中阅读故障代表并根据此做判断。和前一代的OBD相比，OBD-II标准规定了诊断接头的类型，以及信息格式和针脚定义（参考下图）。同时，OBD-II还提供了一个监测参数的candidate list，以及如何进行对应编码的方法，当然这个不是强制遵循的。更重要的是，OBD-II提供了关于DTC（Diagnostic Trouble Code）的扩展list。得益于上述这些标准化进程， 现在有很多第三方工具可以监测和显示以及记录大部分信息，即使car的品牌型号不同。相应的设备我们之后会有所提及。</p>
<p>那么，OBD-II系统到底输出的是什么信息呢？总的来说可以分为3类</p>
<ol class="arabic simple">
<li>Diagnostic Trouble Codes (DTCs)诊断错误码</li>
<li>汽车运行实时数据</li>
<li>冻结帧</li>
</ol>
<p>DTCs就是简单的错误代码，根据错误代码可以判断汽车当前的问题是什么。这里有DTC简单的对应表，这里则有非常详尽的error code信息。这里需要注意的是，并不是任何时候你都能看到DTCs的输出，通常情况下只有错误提示灯，比如Check Engine Light亮起的时候，才会有相关数据输出。</p>
<p>实时数据则是从汽车传感器中上传到OBD系统的数据，其中一些数据是监测汽车性能的关键，比如当前速度，引擎室温度，RPM等等。</p>
<p>而冻结帧则是实时传感器数据在有错误代码产生时候的snapshot，主要是用来当车子出毛病的时候，参考当时传感器数据来推断当时的情况。</p>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id22">数据协议标准</a></h2>
<p>OBD-II标准包含了不同的协议来实现汽车与诊断设备之间的数据传输</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="22%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">名称</th>
<th class="head">速度</th>
<th class="head">用途</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>ISO 9141</td>
<td>10.4 kbaud</td>
<td>大多数亚洲和欧洲制造商</td>
</tr>
<tr><td>J1850 PWM</td>
<td>41.6 kbaud</td>
<td>Ford, Mazda</td>
</tr>
<tr><td>J1850 VPW</td>
<td>41.6 kbaud</td>
<td>主要是GM</td>
</tr>
<tr><td>CAN</td>
<td>250/500 kbit/s</td>
<td>较新的车辆，包括所有2008年及之后在销售的车辆</td>
</tr>
</tbody>
</table>
<p>前三种协议是各路诸侯分别割据的结果，而第四种CAN协议是一个新兴的但普及极快的标准
，以后也将成为事实上的所有汽车的标准。CAN协议已经被欧洲和北美的汽车制造商广泛应
用。 作为战略步骤，新型的 GM 汽车已经完全基于CAN协议。完全支持CAN协议的还包括
2004年后生产的Ford, Jaguar, Mazda, Mercedes, Nissan, and Toyota等等等等。对于
CAN的具体介绍请参见这里。</p>
<p>那你怎么判定你的爱车到底支持的是什么协议呢？你可以通过检查连接针脚来判断。参考
刚才给出的接口针脚示意图，</p>
<ul class="simple">
<li>J1850 VPW–接头在2, 4, 5和16处有金属针脚, 但是10处没有</li>
<li>ISO 9141-2–接头在4, 5, 7, 16处有针脚，但在15处可能没有.</li>
<li>J1850 PWM–接头在2, 4, 5, 10，16处有针脚</li>
<li>CAN－接头在4，5，6，14和16处都有针脚</li>
</ul>
</div>
</div>
<div class="section" id="id5">
<h1><a class="toc-backref" href="#id23">OBD工具</a></h1>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id24">硬件工具</a></h2>
<p>目前市面上主要有两大类OBD-II的硬件工具，一种是单独的主要用于诊断的手持设备，一种是纯电缆，能让OBD接口和你的电脑通信，但需要有相应的软件运行在电脑端。对于普通爱好者来说，一般都会选择第二种，可以DIY，也可以买现成的之后自订制，软件还可以更换和修改，最关键的是不贵，通常也就是10-40美元不等，有
<a class="reference external" href="http://www.scantool.net/scan-tools/obdlink-ci.html">USB接口</a> 的，有串口接口的，有
<a class="reference external" href="http://www.scantool.net/scan-tools/obdlink.html">蓝牙接口</a>
的，都很全，google就能goo出一大堆。当然还有一些就是也是单独的设备，但是主要显示的是各种传感器信息的，比如
<a class="reference external" href="http://www.scangauge.com/">这个</a>
。但由于硬件和软件绑定，我个人对于这种东西的兴趣不大。</p>
</div>
<div class="section" id="id9">
<h2><a class="toc-backref" href="#id25">软件工具</a></h2>
<p>首先需要说明的是，并不是每款OBD工具都可以用在转换电缆上，在使用之前必须确认清楚
你手头的软件和硬件电缆是不是兼容。由于我自己用的电缆就是从Scantool来的，所以我
所用的软件自然也是从上面下的，<a class="reference external" href="http://www.scantool.net/">Scantool</a> 最好的一点就是它的cable有一堆的商用软件都
和其兼容，更重要的是它还提供开源的应用程序，虽然是在windows上使用的。如果你想找
Linux下的开源程序研究，可以看看 <a class="reference external" href="http://freediag.sourceforge.net/">Freediag</a> 。如果你使用的是像Palm这样的手持设备，那
可以去看看 <a class="reference external" href="http://www.autotap.com/products.html">Autotap</a> 的产品线。</p>
</div>
<div class="section" id="id10">
<h2><a class="toc-backref" href="#id26">如何购买适合自己的工具</a></h2>
<p>虽然以后我可能会在Blog上介绍一些自己DIY工具的知识，但也许有的人就想买整套的工具并直接使用。这里就大概说一下如果想买相关工具，需要注意哪些问题？</p>
<p>目前能在互联网上找到的工具五花八门，直接挑很容易就挑花了眼。一般来说，从以下几个方面入手选择：</p>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id27">这套工具能用于你的爱车么？</a></h3>
<blockquote>
我们都知道OBDII是标准协议，但是具体到硬件层的通信，不同的厂商就会有不同的通信协议了。有一些工具是支持全套的通信协议的，有一些工具则只支持特定厂商汽车的协议。所以在购买之前，首先确定工具所能支持的通信协议是否和你的车辆兼容。</blockquote>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id28">这套工具能支持哪些参数输出？</a></h3>
<blockquote>
所有强制支持OBD的车辆，被要求输出的信息仅仅是关于排放方面的信息，这些信息由SAE specification J1979 规定。也就是说，很多其他的传感器信息是否输出，怎么输出，是取决于各个厂商的不同决定。而一些低端的设备呢，就仅仅支持读取这些关于排放方面的数据。如果一款工具仅仅支持legislated参数，那就要小心了，而如果一款工具宣称支持enhanced参数集，那这个很可能就是能支持很多别的信息的工具。</blockquote>
</div>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id29">这套工具是可升级的么？</a></h3>
<blockquote>
每一年，汽车厂商都会更新换代各种型号，如果你希望你的scan工具不是在每一次汽车型号更新之后就不能继续使用的话，那你所挑选的工具就必须具有固件可升级性，当然升级可能又是另一笔很大的开销了。</blockquote>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id30">这套工具的说明文档完整么？</a></h3>
<blockquote>
想一想，假设你费劲千辛万苦，让工具和你的汽车通信成功了，你也能从工具中看到DTC代码了，但你知道具体的代码分别表示什么不同的意义么？一款好的工具，应该尽可能多地把信息呈现给用户，而不是给用户纯数据，然后自己去查询数据所表示的含义。当然，目前大多数的scantool软件都支持图形化显示传感器数据了。</blockquote>
</div>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id31">这套工具有没有数据记录功能？</a></h3>
<blockquote>
不要觉得这个工具不重要，有几个人能够边开车边分析实时数据的？如果工具有data logging的功能，对你旅途之后分析爱车的性能有着巨大的帮助。</blockquote>
</div>
</div>
</div>
<div class="section" id="id16">
<h1><a class="toc-backref" href="#id32">OBD资料汇总</a></h1>
<p>关于OBD方面的书，传说中号称圣经级别的是OBD II Diagnostic Secrets Revealed。另一本非常好的书是Ralph Birnbaum写的Getting to Know OBD II。你可以在
<a class="reference external" href="http://www.obd-2.com/books.htm">这里</a>
找到它们和其他几乎所有和OBD相关的书的购买链接。</p>
<p>关于CAN总线的资料，可以参考
<a class="reference external" href="http://www.kvaser.com/can/protocol/index.htm">Kvaser CAN Protocol Tour</a></p>
<p>OBD相关资料中可能出现的
<a class="reference external" href="http://www.obdii.com/acronyms.html">各种各样的缩写</a> 。</p>
</div>
</div>
</body>
</html>
